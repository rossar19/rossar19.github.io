---
layout: noheader
---

<h1 class="data-header">Header</h1>
<p class="data-copy">Copy goes here.  Lorem ipsum dolor sit amet, consectetur adipisicing elit,
sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad
minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
commodo consequat. Duis aute irure dolor in reprehenderit in voluptate .</p>

<div class="wrapper"></div>

<script>
	var pageTitle = "Header";
	var drawCountries = function() {
		d3.select('.wrapper').selectAll("*").remove();
		d3.select('.back-btn').remove();
		d3.select('.data-header').text(pageTitle);
		for (var i = 0; i < 45; i++) {
			var country = d3.select('.wrapper')
				.append("div")
				.attr("id", "c" + i)
				.attr("class", "country");

			var name = country.append("h4")
				.attr("class", "country--name")
				.text("Name " + i);

			var block = country.append("div")
				.attr("class", "country--block");

			var id = "#c" + i;

			d3.select(id).on("click", function(e) {
				d3.select(".data-header")
				.text(
					d3.select(this)
					.select(".country--name")
					.text()
				);

				d3.select(".wrapper").selectAll("*").remove();

				addFilterBtns();
			});
		}
	}

	var addFilterBtns = function() {
		var btnWrap = d3.select(".wrapper")
			.append("div")
			.attr("class", "btn-wrapper");

		var dataWrap = d3.select(".wrapper")
			.append("div")
			.attr("class", "data-wrapper");

		d3.select(".data-copy")
			.append("a")
			.attr("class", "back-btn")
			.attr("href", "javascript:drawCountries()")
			.text("Choose a different country");

		var filters = {
			"Sex": ["Male", "Female"],
			"Age": ["Under 18", "18-24", "25-44", "45-60", "Over 60"],
			"Job Status": ["In paid employment", "Unemployed and looking for work", "Student", "Apprentice or trainee", "Retired", "Unemployed and not looking for work"],
			"Marital Status": ["Married", "Legal Civil Union", "Widowed", "Divorced", "Separated", "None of these"],
			"# of Children": [0,1,2,3,4,5,6]
		};

		for (var n in filters) {
			var btn = btnWrap.append("button")
			.attr("id", n)
			.attr("class", "filter-btn")
			.text(n);

			var html = d3.select(".data-wrapper");

			if (d3.select(".data-wrapper").html() == "") {
				displaySubs(filters[n]);
			}

			btn.on("click", function(e) {
				dataWrap.selectAll("*").remove();
				displaySubs(filters[this.id]);
			});
		}
	}

	var displaySubs = function(arr) {
		for (var n in arr) {
			d3.select(".data-wrapper").append("span").attr("class", "category").text(arr[n]);
		}
	}

	drawCountries();

	d3.csv("Global Attitudes - shortCSV.csv", function(error, data) {

	    	var nestByCountry = d3.nest()
	    	.key(function(d, i) {
	    		return d.Country;
	    	})
	    	.entries(data);

		  	console.log(nestByCountry);
	    });
</script>
